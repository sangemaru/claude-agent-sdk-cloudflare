name = "claude-agent-worker"
main = "server.ts"
account_id = "c41f1934b3a0975522e90a532420b594"
compatibility_date = "2025-09-23"
compatibility_flags = ["nodejs_compat"]

[observability]
enabled = true

[[containers]]
class_name = "AgentContainer"
image = "./Dockerfile"
max_instances = 6
instance_type = "basic"

[[durable_objects.bindings]]
name = "AGENT_CONTAINER"
class_name = "AgentContainer"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["AgentContainer"]

[[r2_buckets]]
binding = "SKILLS_BUCKET"
bucket_name = "claude-agents-sdk"

# Secret bindings (actual values set via `wrangler secret put`)
# These are environment variables that should be configured as secrets:
# - CLAUDE_ACCESS_TOKEN: Claude Max subscription OAuth access token
# - CLAUDE_REFRESH_TOKEN: Claude Max subscription OAuth refresh token
# - CLAUDE_EXPIRES_AT: OAuth token expiration timestamp
# - ANTHROPIC_API_KEY: Anthropic API key (alternative to OAuth)
# - WORKER_API_KEY: Worker authentication key
#
# To set secrets, run:
#   wrangler secret put CLAUDE_ACCESS_TOKEN
#   wrangler secret put CLAUDE_REFRESH_TOKEN
#   wrangler secret put CLAUDE_EXPIRES_AT
#   wrangler secret put ANTHROPIC_API_KEY
#   wrangler secret put WORKER_API_KEY
